# TBS Dropbox Inventory Visualizer - Coding Plan

## Overview

A single-page HTML application that loads the inventory JSON and provides interactive visualizations for migration planning. No server required - runs entirely in the browser.

---

## Target Users & Use Cases

| User | Use Case |
|------|----------|
| Franz | Identify large folders for storage class decisions, find files for thesis |
| Ciara | Review folder priorities, check embargo status by project |
| Pablo/VÃ­ctor | Understand data structure for DataHub pipeline design |
| Gonzalo | Quick overview of total storage, share with MIT collaborators |

---

## App Architecture

```
tbs_inventory_explorer/
â”œâ”€â”€ index.html              # Main app (single file, self-contained)
â”œâ”€â”€ inventory.json          # Data file (generated by Python script)
â””â”€â”€ README.md               # Usage instructions
```

**Tech Stack:**
- Pure HTML/CSS/JavaScript (no build tools needed)
- D3.js for treemap visualization
- Vanilla JS for folder navigator
- CSS Grid/Flexbox for layout

---

## Feature Specifications

### Tab 1: Folder Navigator (Priority: HIGH)

**Purpose:** Browse the folder hierarchy with summary statistics at each level.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ USFQ Tiputini                                    2.3 TB totalâ”‚
â”‚    â”œâ”€â”€ ğŸ“Š 4,521 files â”‚ ğŸ“ 89 folders â”‚ ğŸ“… 2017-2025           â”‚
â”‚    â””â”€â”€ Extensions: .jpg (45%), .dat (30%), .tif (15%), other    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶ ğŸ“ INVESTIGACIÃ“N TBS          2.2 TB    [====â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 96%  â”‚
â”‚  â–¶ ğŸ“ MULTIMEDIA                 105 GB    [â–ˆ           ]  4%  â”‚
â”‚  â–¶ ğŸ“ APLICACIONES Y BECAS       0 MB      [            ]  0%  â”‚
â”‚  â–¶ ğŸ“ PROGRAMAS ACADEMICOS       0 MB      [            ]  0%  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Clicking "â–¶ INVESTIGACIÃ“N TBS" expands:

â”‚  â–¼ ğŸ“ INVESTIGACIÃ“N TBS          2.2 TB                        â”‚
â”‚     â–¶ ğŸ“ DATA                    2.2 TB    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 99%  â”‚
â”‚     â–¶ ğŸ“ ADMINISTRATIVO          12 MB     [            ]  1%  â”‚
```

**Features:**
- [x] Expandable/collapsible folder tree
- [x] Size bar showing % of parent
- [x] File count, folder count per level
- [x] Top 3 extensions with percentages
- [x] Date range (earliest to latest modified)
- [x] Click folder row to see details panel
- [x] Breadcrumb navigation at top
- [x] Search box to filter/find folders

**Data Structure Needed:**
```javascript
{
  path: "/USFQ Tiputini/INVESTIGACIÃ“N TBS/DATA",
  name: "DATA",
  type: "folder",
  size_bytes: 2200000000000,
  file_count: 4521,
  folder_count: 89,
  extensions: { ".jpg": 2034, ".dat": 1356, ".tif": 678 },
  date_range: { min: "2017-03-15", max: "2025-01-08" },
  children: [ /* nested folders/files */ ]
}
```

---

### Tab 2: Treemap Visualization (Priority: HIGH)

**Purpose:** Visual representation of storage distribution, like SpaceSniffer.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                              â”‚ â”‚            â”‚ â”‚         â”‚ â”‚
â”‚   â”‚     LIFEPLAN Audio           â”‚ â”‚  Drones    â”‚ â”‚ Jaguaresâ”‚ â”‚
â”‚   â”‚        ~900 GB               â”‚ â”‚  Gonzalo   â”‚ â”‚  62 GB  â”‚ â”‚
â”‚   â”‚                              â”‚ â”‚  224 GB    â”‚ â”‚         â”‚ â”‚
â”‚   â”‚                              â”‚ â”‚            â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚   â”‚                              â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ Delfinesâ”‚ â”‚
â”‚   â”‚                              â”‚ â”‚ SelvaTek   â”‚ â”‚  9 GB   â”‚ â”‚
â”‚   â”‚                              â”‚ â”‚  185 GB    â”‚ â”‚         â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        Breadcrumb: / > USFQ Tiputini > INVESTIGACIÃ“N TBS > DATA
```

**Features:**
- [x] Rectangles sized proportionally to folder/file size
- [x] Color coding by file type or depth level
- [x] Hover shows: name, size, file count
- [x] Click to drill down into folder
- [x] Breadcrumb to navigate back up
- [x] Zoom controls (or scroll to zoom)
- [x] Toggle: show files vs folders only
- [x] Minimum size threshold slider (hide tiny files)

**Color Scheme Options:**
```javascript
const colorSchemes = {
  byType: {
    images: "#4CAF50",    // green - .jpg, .jpeg, .png, .tif
    audio: "#2196F3",     // blue - .dat, .wav, .mp3
    video: "#FF9800",     // orange - .mp4
    documents: "#9C27B0", // purple - .pdf, .xlsx, .docx
    data: "#607D8B",      // gray - .csv, .gdb
    other: "#795548"      // brown
  },
  byDepth: {
    1: "#1a237e",  // dark blue
    2: "#283593",
    3: "#3949ab",
    4: "#5c6bc0",
    5: "#7986cb"   // lighter blue
  }
}
```

---

### Tab 3: Statistics Dashboard (Priority: MEDIUM)

**Purpose:** Overview charts and metrics for migration planning.

**Panels:**

#### Panel A: Storage Summary
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Total Storage: 2.9 TB                  â”‚
â”‚  Total Files: 152,847                   â”‚
â”‚  Total Folders: 1,234                   â”‚
â”‚  Avg File Size: 19.4 MB                 â”‚
â”‚  Largest File: TBS_all_RGB.tif (119 GB) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Panel B: File Type Distribution (Pie Chart)
```
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â•±    .jpg       â•²
   â”‚     45%         â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
   â”‚  â”‚  .dat   â”‚    â”‚
    â•² â”‚  30%    â”‚   â•±
     â•²â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•±
      â•²  .tif 15%â•±
       â•²________â•±
```

#### Panel C: File Size Distribution (Histogram)
```
Files by Size Range:
< 1 MB    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  78,234
1-10 MB   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              42,156
10-100 MB â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                  28,432
100MB-1GB â–ˆâ–ˆ                         3,891
> 1 GB    â–ˆ                            134
```

#### Panel D: Timeline (Files by Year)
```
     â”‚    â–„â–„
     â”‚   â–ˆâ–ˆâ–ˆâ–ˆ  â–„â–„
     â”‚   â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–„â–„â–„â–„
     â”‚â–„â–„ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      2019 2020 2021 2022 2023 2024 2025
```

#### Panel E: Top 10 Largest Folders
```
1. LIFEPLAN/Audio recorder     ~900 GB
2. Drones_Gonzalo               224 GB
3. Camera Trap Jaguares         ~62 GB
4. MULTIMEDIA/BACKUP            105 GB
   ...
```

---

### Tab 4: Search & Filter (Priority: MEDIUM)

**Purpose:** Find specific files/folders, export filtered results.

**Filters:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” Search: [camera trap_______________]                     â”‚
â”‚                                                             â”‚
â”‚ File Type:  â˜‘ Images  â˜‘ Audio  â˜ Video  â˜ Documents        â”‚
â”‚ Size Range: [0 MB] â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ [500 GB]                â”‚
â”‚ Date Range: [2020-01-01] to [2025-12-31]                   â”‚
â”‚ Folder:     [/USFQ Tiputini/INVESTIGACIÃ“N TBS/DATA â–¼]      â”‚
â”‚                                                             â”‚
â”‚ [Apply Filters]  [Reset]  [Export CSV]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Results Table:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name              â”‚ Path           â”‚ Size    â”‚ Modified     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ jaguar_001.jpg    â”‚ /DATA/Jaguares â”‚ 4.2 MB  â”‚ 2024-03-15   â”‚
â”‚ jaguar_002.jpg    â”‚ /DATA/Jaguares â”‚ 3.8 MB  â”‚ 2024-03-15   â”‚
â”‚ ...               â”‚ ...            â”‚ ...     â”‚ ...          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Showing 1,234 of 152,847 files  â”‚  Total size: 4.8 GB
```

---

### Tab 5: Migration Planner (Priority: LOW - Future Enhancement)

**Purpose:** Tag folders with priority, embargo, storage class for DataHub planning.

**Features:**
- Add priority tags (Alta/Media/Baja) to folders
- Set embargo status per folder
- Assign storage class (Standard/Nearline/Coldline/Archive)
- Calculate estimated monthly cost based on selections
- Export migration plan as JSON/CSV

---

## Implementation Plan

### Phase 1: Core Structure (Day 1)

**Tasks:**
1. [ ] Create HTML skeleton with tab navigation
2. [ ] Implement JSON loader with drag-and-drop support
3. [ ] Build data transformation layer (flat list â†’ nested tree)
4. [ ] Create utility functions (formatBytes, formatDate, etc.)

**Code Structure:**
```html
<!DOCTYPE html>
<html>
<head>
  <title>TBS Inventory Explorer</title>
  <style>/* All CSS here */</style>
</head>
<body>
  <header>
    <h1>TBS Dropbox Inventory Explorer</h1>
    <nav><!-- Tab buttons --></nav>
  </header>
  
  <main>
    <section id="tab-navigator"><!-- Folder tree --></section>
    <section id="tab-treemap"><!-- D3 treemap --></section>
    <section id="tab-stats"><!-- Charts --></section>
    <section id="tab-search"><!-- Filter/search --></section>
  </main>
  
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>/* All JS here */</script>
</body>
</html>
```

### Phase 2: Folder Navigator (Day 2)

**Tasks:**
1. [ ] Implement collapsible tree component
2. [ ] Calculate folder statistics (size, count, extensions)
3. [ ] Add size bars and percentage indicators
4. [ ] Implement breadcrumb navigation
5. [ ] Add search/filter functionality

**Key Functions:**
```javascript
function buildFolderTree(flatEntries) { }
function calculateFolderStats(folder) { }
function renderFolderNode(folder, depth) { }
function toggleFolder(path) { }
function navigateTo(path) { }
```

### Phase 3: Treemap Visualization (Day 3)

**Tasks:**
1. [ ] Set up D3.js treemap layout
2. [ ] Implement zoom/drill-down behavior
3. [ ] Add color coding by file type
4. [ ] Create tooltip on hover
5. [ ] Add breadcrumb for navigation
6. [ ] Implement smooth transitions

**Key Functions:**
```javascript
function createTreemap(data, container) { }
function zoomToNode(node) { }
function colorByType(node) { }
function updateBreadcrumb(path) { }
```

### Phase 4: Statistics Dashboard (Day 4)

**Tasks:**
1. [ ] Calculate summary statistics
2. [ ] Create pie chart for file types (D3 or Chart.js)
3. [ ] Create histogram for size distribution
4. [ ] Create timeline bar chart by year
5. [ ] Create top 10 largest items list

### Phase 5: Search & Polish (Day 5)

**Tasks:**
1. [ ] Implement multi-criteria search
2. [ ] Add export to CSV functionality
3. [ ] Performance optimization for large datasets
4. [ ] Responsive design for different screen sizes
5. [ ] Add loading indicators
6. [ ] Error handling and edge cases

---

## Technical Considerations

### Performance Optimization

For 150,000+ entries:

```javascript
// 1. Virtual scrolling for large lists
// Only render visible items + buffer
const visibleItems = entries.slice(scrollTop, scrollTop + viewportHeight + buffer);

// 2. Web Workers for heavy calculations
const worker = new Worker('stats-worker.js');
worker.postMessage(entries);
worker.onmessage = (e) => updateStats(e.data);

// 3. Debounce search input
const debouncedSearch = debounce(searchFiles, 300);

// 4. Lazy load treemap levels
// Only compute children when user drills down

// 5. Use Maps for O(1) lookups
const entriesByPath = new Map(entries.map(e => [e.path, e]));
```

### Data Transformation

Convert flat CSV/JSON to nested structure:

```javascript
function buildTree(flatEntries) {
  const root = { name: "root", path: "/", children: [], size_bytes: 0 };
  const pathMap = new Map([["/", root]]);
  
  // Sort by path depth to ensure parents exist
  const sorted = flatEntries.sort((a, b) => 
    a.path.split('/').length - b.path.split('/').length
  );
  
  for (const entry of sorted) {
    const parentPath = entry.parent_folder || "/";
    const parent = pathMap.get(parentPath);
    
    if (parent) {
      const node = { ...entry, children: [] };
      parent.children.push(node);
      pathMap.set(entry.path, node);
    }
  }
  
  // Calculate aggregated sizes
  calculateSizes(root);
  return root;
}
```

### Responsive Design Breakpoints

```css
/* Desktop (default) */
.treemap { height: 600px; }
.folder-tree { max-height: 800px; }

/* Tablet */
@media (max-width: 1024px) {
  .tabs { flex-direction: column; }
  .treemap { height: 400px; }
}

/* Mobile */
@media (max-width: 768px) {
  .folder-tree { font-size: 14px; }
  .stats-grid { grid-template-columns: 1fr; }
}
```

---

## File Format Requirements

### Input: inventory.json

```json
{
  "summary": {
    "generated": "2025-01-09T15:30:00",
    "total_files": 152847,
    "total_folders": 1234,
    "total_size_gb": 2.9,
    "api_calls_made": 78
  },
  "entries": [
    {
      "type": "file",
      "name": "jaguar_001.jpg",
      "path": "/USFQ Tiputini/INVESTIGACIÃ“N TBS/DATA/Jaguares/jaguar_001.jpg",
      "extension": ".jpg",
      "size_bytes": 4200000,
      "size_mb": 4.2,
      "modified": "2024-03-15T10:30:00",
      "content_hash": "abc123...",
      "parent_folder": "/USFQ Tiputini/INVESTIGACIÃ“N TBS/DATA/Jaguares",
      "folder_depth": 5
    }
  ]
}
```

---

## Success Criteria

### MVP (Minimum Viable Product)
- [ ] Load JSON file via drag-and-drop or file picker
- [ ] Display folder tree with sizes and file counts
- [ ] Treemap visualization with click-to-zoom
- [ ] Basic statistics (total size, file count, type distribution)

### Version 1.0
- [ ] All 4 tabs fully functional
- [ ] Search and filter working
- [ ] Export filtered results to CSV
- [ ] Responsive on tablet/mobile
- [ ] Handles 150k+ entries without lag

### Future Enhancements (v2.0)
- [ ] Migration planner with cost calculator
- [ ] Compare two inventory snapshots (before/after migration)
- [ ] Integration with Google Cloud Storage pricing API
- [ ] Save/load folder annotations (priorities, embargoes)
- [ ] Share view via URL parameters

---

## External Dependencies

| Library | Version | Purpose | CDN |
|---------|---------|---------|-----|
| D3.js | 7.x | Treemap, charts | `https://d3js.org/d3.v7.min.js` |
| (Optional) Chart.js | 4.x | Pie/bar charts | `https://cdn.jsdelivr.net/npm/chart.js` |

**Note:** Keep dependencies minimal. D3.js alone can handle all visualizations.

---

## Estimated Timeline

| Phase | Duration | Deliverable |
|-------|----------|-------------|
| Phase 1 | 4 hours | HTML structure, data loader |
| Phase 2 | 6 hours | Folder navigator complete |
| Phase 3 | 6 hours | Treemap visualization complete |
| Phase 4 | 4 hours | Statistics dashboard complete |
| Phase 5 | 4 hours | Search, polish, testing |
| **Total** | **~24 hours** | **Full MVP** |

---

## Next Steps

1. Wait for inventory script to complete
2. Review generated JSON structure
3. Start with Phase 1: HTML skeleton
4. Iterate based on actual data patterns

---

*Document created for TBS DataHub Migration Project - January 2025*
